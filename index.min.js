class Moment{constructor(time){let reg=/^\d{4}-\d{1,2}-\d{1,2}(T\d{1,2}:\d{1,2}:\d{1,3})?$/;this.time=reg.test(time)?new Date(time.replace("T"," ")):new Date}date(){return this.time.getDate()}day(num){if(num){let week=new Date(this.time).getDay();return this.add(num-week,"d"),this}return this.time.getDay()+""}monthWeek(){let day=this.time.getDay()||7,date=this.time.getDate();return Math.ceil((day+date)/7)}yearWeek(){let year=this.time.getFullYear(),diff=this.time-new Date(`${year}-1-1`)+1e3*(new Date(`${year}-1-1`).getDay()||7)*60*60*24;return Math.ceil(diff/6048e5)}month(){return this.time.getMonth()+1+""}quarter(){return Math.ceil((this.time.getMonth()+1)/3)+""}year(){return this.time.getFullYear()+""}add(num,type){let date=this.time.getDate(),year=this.time.getFullYear(),month=this.time.getMonth(),hour=this.time.getHours(),minute=this.time.getMinutes(),seconds=this.time.getSeconds(),result;switch(type){case"y":if(year+=num,2==month){let lastDate=new Date(year,2,0);date=date<=lastDate?date:lastDate}result=new Date(year,month,date,hour,minute,seconds);break;case"Q":{let months=12*year+3*num+month;year=~~(months/12),month=months%12;let lastDate=new Date(year,month,0);date=date<=lastDate?date:lastDate,result=new Date(year,month,date,hour,minute,seconds)}break;case"M":{let months=12*year+num+month;console.log(months),year=~~(months/12),month=months%12;let lastDate=new Date(year,month,0);date=date<=lastDate?date:lastDate,result=new Date(year,month,date,hour,minute,seconds)}break;case"w":result=new Date(this.time.getTime()+6048e5*num);break;case"d":result=new Date(this.time.getTime()+864e5*num);break;case"h":result=new Date(this.time.getTime()+36e5*num);break;case"m":result=new Date(this.time.getTime()+6e4*num);break;case"s":result=new Date(this.time.getTime()+1e3*num);break;default:console.warn("格式错误"),result=this.time}return this.time=result,this}startDay(type){let year=this.time.getFullYear(),month=this.time.getMonth(),quarter=Math.ceil((month+1)/3),result;switch(type){case"Y":result=`${year}-1-1`;break;case"Q":result=`${year}-${3*quarter-2}-1`;break;case"M":result=`${year}-${month}-1`;break;case"w":result=new Moment(this.time).add(1-this.time.getDay(),"d").format();break;default:console.warn("startDay 错误")}return result}endDay(type){let year=this.time.getFullYear(),month=this.time.getMonth()+1,quarter=Math.ceil(month/3),result;switch(type){case"Y":result=`${year}-12-31`;break;case"Q":result=`${year}-${3*quarter}-${new Date(year,3*quarter,0).getDate()}`;break;case"M":let date;result=`${year}-${month}-${new Date(year,month,0).getDate()}`;break;case"w":result=new Moment(this.time).add(7-this.time.getDay(),"d").format();break;default:console.warn("startDay 错误")}return result}format(format="YYYY-MM-DD"){let ret,time=this.time,option={"Y+":"0000"+time.getFullYear(),"M+":"0000"+(time.getMonth()+1),"D+":"0000"+time.getDate(),"h+":"0000"+time.getHours(),"m+":"0000"+time.getMinutes(),"s+":"0000"+time.getSeconds()};for(let key of Object.keys(option))ret=new RegExp(`(${key})`).exec(format),ret&&(format=format.replace(ret[1],option[key].substring(option[key].length-ret[1].length)));return format}}export default Moment;